function [img ] = msah_hw6_p4a(f,p)

filename = f;
rank = p;

% Read and Show file image
img_filename = imread(filename);  
% imshow(img_filename);

double_value_filename = double(img_filename);

[m , n , c ] = size(img_filename);
ranked_m = round(m * p * 0.01);
ranked_n = round(n * p * 0.01);
single_ranked = round(m * p * 0.01);


R = double_value_filename( : , : , 1 ) ;
G = double_value_filename( : , : , 2 ) ;
B = double_value_filename( : , : , 3 ) ;



[ uR ,sR, vR ] = svd(R);
[ uG ,sG, vG ] = svd(G);
[ uB ,sB, vB ] = svd(B);
 

SR = sR ; 
SG = sG ; 
SB = sB ;

%  
% SR(ranked_m: m , : ) = 0 ;
% SR( : , ranked_n : n ) = 0 ;
% 
% SG(ranked_m: m , : ) = 0 ;
% SG( : , ranked_n : n ) = 0 ;
% 
% SB(ranked_m: m , : ) = 0 ;
% SB( : , ranked_n : n ) = 0 ;


SR(single_ranked: m , : ) = 0 ;
SR( : , ranked_n : n ) = 0 ;

SG(ranked_m: m , : ) = 0 ;
SG( : , ranked_n : n ) = 0 ;

SB(ranked_m: m , : ) = 0 ;
SB( : , ranked_n : n ) = 0 ;

% SR(ranked_m: m ,  ranked_n : n  ) = 0 ;
% SG(ranked_m: m , ranked_n : n ) = 0 ;
% SB(ranked_m: m , ranked_n : n ) = 0 ;

% temp_imgR = uR * SR * vR';
% imshow(temp_imgR)

% temp_imgG = uG * SG * vG';
% imshow(temp_imgG)

% temp_imgB = uB * SB * vB';
% imshow(temp_imgB)
size(uR(: ,  1:ranked_n ))
size(SR)
size(vR(1: ranked_n , :))
 
%size(vR)
vR = vR';
vG = vG' ;
vB = vB';


%size(vR)
output_image_R = uR(: ,  1:ranked_n ) * SR * vR(1: ranked_n , :);
output_image_G = uG(: ,  1:ranked_n ) * SG * vG(1: ranked_n , :);
output_image_B = uB(: ,  1:ranked_n ) * SB * vB(1: ranked_n , :);

combine_image = cat( 3 , output_image_R, output_image_B , output_image_G);
combine_image = uint8(combine_image);

imshow(combine_image);


end

